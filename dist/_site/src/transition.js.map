{"version":3,"file":"transition.js","sourceRoot":"","sources":["../../../_site/src/transition.ts"],"names":[],"mappings":"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","sourcesContent":["import { ElementRef, Output, Directive, EventEmitter, Renderer2, Input } from '@angular/core';\nimport { Subscription } from 'rxjs/Subscription';\nimport { Content, Platform } from 'ionic-angular'\n\n@Directive({\n  selector: '[transition]' // Attribute selector\n})\nexport class TransitionDirective {\n\n  @Output() appear: EventEmitter<boolean>;\n  @Input() nav: any;\n  @Input() searchbar: any;\n  @Input() toolbar: any;\n  @Input() contentbox: any;\n  @Input() fade: any;\n  @Input() forceIOS: boolean = false;\n  ios: boolean = false;\n  subscriptionScroll: Subscription;\n  state: boolean = false;\n\n  private changes: MutationObserver;\n  @Output()\n  public domChange = new EventEmitter();\n\n  constructor(private element: ElementRef, private renderer: Renderer2, private content: Content,private platform: Platform) {\n\n  }\n\n  ngAfterViewInit(){\n    this.platform.ready().then(() => {\n      this.ios = this.platform.is('ios') || this.forceIOS;\n      if (this.ios) this.initIOS();\n      else this.initAndroid();\n    });\n  }\n\n  initIOS(){\n    this.changes = new MutationObserver((mutations: MutationRecord[]) => {\n      if (this.contentbox.clientHeight < this.content.contentHeight) this.transitionToBody();\n    });\n    this.changes.observe(this.contentbox, {\n      attributes: true,\n      childList: true,\n      characterData: true\n    });\n    this.renderer.setStyle(this.element.nativeElement, 'transition', 'opacity 1s linear');\n    this.renderer.setStyle(this.element.nativeElement, 'opacity', '1');\n    this.appear = new EventEmitter<boolean>();\n    let height = this.toolbar.clientHeight + 10;\n    let styleheight = height + 'px';\n    this.renderer.setStyle(this.toolbar, 'min-height', styleheight)\n    this.renderer.setStyle(this.fade, 'opacity', '0');\n    this.renderer.setStyle(this.fade, 'transition', 'opacity 0.155s linear');\n    this.subscribe();\n  }\n\n  initAndroid(){\n    this.renderer.setStyle(this.element.nativeElement, 'display', 'none');\n    this.renderer.setStyle(this.fade, 'opacity', '1');\n    if (this.searchbar) this.renderer.appendChild(this.nav, this.searchbar._elementRef.nativeElement)\n  }\n\n  subscribe(){\n    this.subscriptionScroll =  this.content.ionScroll\n      .subscribe((data) => {\n        if (!this.state && data.scrollTop >= this.element.nativeElement.offsetHeight-5){\n          this.state = true;\n          this.transitionToHeader()\n        }\n        if (this.state && data.scrollTop < this.element.nativeElement.offsetHeight){\n          this.state = false;\n          this.transitionToBody()\n        }\n      });\n  }\n\n  transitionToHeader(){\n    this.renderer.setStyle(this.fade, 'opacity', '1');\n    if (this.searchbar) this.renderer.appendChild(this.nav, this.searchbar._elementRef.nativeElement)\n  }\n\n  transitionToBody(){\n    if (this.searchbar) this.renderer.appendChild(this.toolbar, this.searchbar._elementRef.nativeElement)\n    this.renderer.setStyle(this.fade, 'opacity', '0');\n  }\n\n  unsubscribe(){\n    if(this.subscriptionScroll){\n      this.subscriptionScroll.unsubscribe();\n    }\n    if (this.changes){\n      this.changes.disconnect();\n    }\n  }\n\n  debug(){\n    console.log('element:', this.element.nativeElement);\n    console.log('toolbar:', this.toolbar);\n    console.log('fade:', this.fade);\n    console.log('searchbar', this.searchbar);\n  }\n\n  ngOnDestroy(){\n    this.unsubscribe();\n  }\n\n}\n"]}